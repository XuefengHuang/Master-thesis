\chapter{RELATED WORK AND MOTIVATION}
\label{sec.relatedwork_motivation}
In this section, we present some background information on factors that motivated the design and deployment of \sysname. First, we look at related works behind the design. Then we talk about the motivation.
\section{Related Work}
\label{ssec.related_work}
Our work shares goals with and builds upon ideas from several prior large scale platforms targeting home network research. In the following paragraphs, we briefly review related works on exsiting research platforms and home network experiments.  

\textbf{Existing research platforms.}The BISmark~\cite{183951} project aims at understanding the performance of wired access networks in homes through the long-term deployment of gateways. We use a similar approach but focus on building a programming framework to balance between flexibility (allowing researchers to do a wide set of experiments) and a constrained programming environment (limiting researchers from doing experiments that could interfere with home users). The RIPE Atlas~\cite{ripeatlas} is a global network of probes that measure Internet connectivity and reachability, providing an unprecedented understanding of the state of the Internet in real time. It has deployed thousands of probing devices worldwide, but their capabilities are limited to simple measurements (e.g., ping, traceroute). Our testbed provide a wide range of capabilities that support the implementation of as wide an array of network measurements as possible. SamKnows~\cite{samknows} has designed and developed its performance tests in house, adhering to IETF RFCs where appropriate. All measurements are written in C, for performance and portability across a range of hardware platforms. But it cannot adapt their measurements procedure and software in the course of a measurement study. \sysname instead allows for very general programmability and rapid code updates on wireless router. BeHop~\cite{yiakoumis2014behop} is a wireless testbed for dense WiFi networks often seen in residential and enterprise settings. \sysname not only evaluate WiFi management strategy, but also study different aspects of home networks, including access link performance, user behavior patterns and topology and connectivity characterization. WiSe~\cite{patro2013observing} is a measurement and management infrastructure that uses APs as vantage points to collect comprehensive information about network. However, WiSe focuses solely on the wireless network properties and not on the rest of the ISP path. \sysname instead focus on both characterization of the wired Internet path from the ISPâ€™s network into the home and the wireless network properties.

Prior works such as~\cite{sanchez2014measurement},~\cite{dhawan2012fathom},~\cite{kreibich2010netalyzr} has focused on end-host techniques for measuring end to end performance in home networks. Dasu~\cite{sanchez2014measurement} is a host-based software that analyzes BitTorrent traffic to characterize ISP performance. Because Dasu piggybacks on BitTorrent, it has a large user base. Fathom~\cite{dhawan2012fathom} is a Firefox extension that provides a programmable interface for writing and launching measurements from the convenience of the web browser. Netalzyr~\cite{kreibich2010netalyzr} also lets users conduct a series of tests from a browser. However, these testbeds cannot support for continuous measurements (i.e., since hosts can be turned off, moved, etc.). In addition, they do not reflect the performance of a fixed network vantage point due to the limitation of host. Our work extends on Seattle Testbed\cite{cappos2009seattle}, which runs on laptops, tablets and smartphones. In contrast to Seattle Testbed, our platform is deployed in home networks on resource-constrained devices and extends eight capabilities based on Seattle sandbox.

Most active measurement and experimentation research relies on dedicated infrastructures (PlanetLab~\cite{chun2003planetlab}, MLab~\cite{mlab}). However, such infrastructures support long-running measurements at cost of limited vantage point diversity because nodes primarily deployed in well-provisioned academic or research networks which are not representative of the real users' Internet. In \sysname, experiments can observe all traffic passing through home wireless router. Scriptroute~\cite{spring2003scriptroute} added the capability for any researchers to run experiments using scripts in a sandboxed environment in PlanetLab. We share Scriptroute's goal of building a community platform for network measurements. However, \sysname is intended for large scale deployment on home wireless routers brings new challenges in particular: resource limitations and home network security.

\textbf{Existing home network experiments.} There has been significant interest in measuring home networks. Previous studies\cite{aguayo2004link}\cite{kotz2005analysis}\cite{raman2009feasibility} use passive measurements to evaluate the performance of 802.11 wireless networks in campus, enterprise, urban and rural environments. For example, \cite{raman2009feasibility} undertakes a detailed measurement study for mesh networks in rural locations, it provides evidence to support a conclusion that external interference is the main cause of unpredictable link behaviour. \cite{kotz2005analysis} conducts a trace-based study of WLAN users in Dartmouth College campus, in an effort to understand patterns of activity in a network. However, this approach does not allow researchers to understand the performance experienced in an environment. For example, it is difficult to infer whether it is due to signal strength or wireless congestion from passive measurements alone when network throughput changes suddenly.

Recent studies have tried to measure home networks in various ways, from the end-host \cite{chetty2011my}\cite{dicioccio2012probe}\cite{sanchez2013trying}, or from gateway routers \cite{grover2013peeking}\cite{sundaresan2015measuring}\cite{patro2013observing}\cite{sundaresan2013measuring}\cite{pefkianakis2015characterizing}. For example in \cite{sundaresan2015measuring}, authors deploy BISmark on commodity routers in 66 homes to identify the relationship between wireless metrics and TCP performance of user traffic. \cite{patro2013observing} deploys WiSe to perform measurements of wireless properties in a wide diversity of homes and presents a simple metric to estimate TCP throughput in their deployments. \cite{sanchez2013trying} studies the complexity of home networks around the world through UPnP measurements collected from Dasu. \cite{sundaresan2013measuring} deploys FCC/SamKnows and BISmark to characterize performance to nine popular Web sites from 5,556 access networks and identify factors that create Web performance bottlenecks. We share \cite{sundaresan2015measuring}'s idea of studying how home wireless performance characteristics affect the performance the user traffic in real homes. However, we also study wireless performance in concert with airtime utilization.

\section{Motivation}
\label{sec.motivation}
We begin by sketching the motivations focus on protection of user privacy, the users' devices, and home networks. The list here is a unique set of challenges when deploying a testbed in home networks. Our design and deployment is in home networks, and hence addressing these issues as well.

\begin{itemize}
\item \textbf{Protecting User Privacy:} \sysname runs on personal wireless routers, which has the potential for violations of privacy if a device owner's network activity and personally identifiable information were to become public. For instance, Data acquired through programming interface can be highly privacy, exposing sensitive information, such as when a user is in home and using the network. We find that it is hard to strike a balance between the need for open data and user privacy during BISmark's development. Therefore, it is necessary to provide a dynamic and flexible access control mechanism to offer an effective privacy protection. In this work, we introduce security layer (see \S{\ref{sec.privacy}}) as one privacy protection mechanism. It is flexible to decide what information is captured on devices and how much information they could share with public. 

\item \textbf{Protecting User Devices:} For a distributed system, it is necessary to control resource consumption on the local host and minimize the impact of Internet connectivity. As such, if an attacker consumes a large amount of resources, it can lead to poor performance. Therefore, managing resources at large scale while providing performance isolation is a key challenge for any distributed system software. Many network testbeds consider this issue when designing their platform. For instance, all experiments on Scriptroute\cite{spring2003scriptroute} are executed in a resource-limited sandbox to protect platform from resource abuse and launching denial-of-service attacks. Dasu also uses a sandbox environment for defining and deploying experiments, and controlling their malicious impact. However, they do not have practical experience on home wireless router. In our work, we propose a secure sandbox running on home wireless router to provide security isolation and performance isolation. From our practical deployment, we find this is a useful environment for running a wide range of experiments while protecting devices.

\item \textbf{Protecting Home Networks:} There is an important difference between \sysname and other testbeds, such as PlanetLab, MLab. Our experiments involve home networks. Attackers can get the control rights of the home network through our platform and send the malicious control commands to different kinds of WiFi enabled devices such as laptop, printers, wireless based security cameras, entertainment devices and other security systems, which may lead to undesired consequences. By exploiting vulnerabilities in home networks, attackers also can gather information on targets, threatening home network's privacy and safety, understanding behaviour and patterns. For instance, some devices can be shut down unusually or the information of some devices can be monitored. To address these issues, we summarize potential network attacks and the solutions to these problems (see \S{\ref{sec.security}})
\end{itemize}

